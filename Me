#!/bin/bash
# ุณูุฑุจุช ุฑูุน ูููุน ุงููุชุงุจ ุนูู GitHub
# ุชุดุบูู: ./deploy_book.sh <GITHUB_USERNAME> <REPO_NAME>

set -e

if [ $# -lt 2 ]; then
  echo "ุงูุงุณุชุฎุฏุงู: ./deploy_book.sh <GITHUB_USERNAME> <REPO_NAME>"
  exit 1
fi

USERNAME=$1
REPO=$2
REPO_URL="https://github.com/$USERNAME/$REPO.git"
BRANCH="main"

# --- ุฅุนุฏุงุฏ ุงููุดุฑูุน ---
mkdir -p $REPO
cd $REPO

# ุฅูุดุงุก index.html ูู ูุด ููุฌูุฏ
if [ ! -f "index.html" ]; then
  cat > index.html <<'EOF'
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ุงููุชุงุจ ุงููุฏุฑุณู - ุงูุซุงูู ุงููุชูุณุท</title>
  <style>
    body { margin:0; padding:0; font-family: sans-serif; background:#f0f0f0; }
    header { background:#333; color:white; padding:10px; text-align:center; }
    iframe { width:100%; height:95vh; border:none; }
  </style>
</head>
<body>
  <header>ุงููุบุฉ ุงูุนุฑุจูุฉ - ุงูุซุงูู ุงููุชูุณุท (ุฌ1)</header>
  <iframe src="book.pdf"></iframe>
</body>
</html>
EOF
fi

# ุถุน ูุณุฎุฉ book.pdf ูู ููุณ ุงููุฌูุฏ ูุจู ุงูุชุดุบูู
if [ ! -f "book.pdf" ]; then
  echo "โ๏ธ ุถูุน ุงูููู book.pdf ุจุฌุงูุจ ุงูุณูุฑุจุช ุฃู ุงูุณุฎู ููุง ูุจู ุงูุฑูุน!"
  exit 1
fi

# --- Git ---
git init
git branch -M $BRANCH
git add .
git commit -m "ุฑูุน ุงููููุน (index.html + book.pdf)"

# ุฅุถุงูุฉ ุงูุฑูููุช
git remote add origin $REPO_URL || git remote set-url origin $REPO_URL

# ุฑูุน ุฅูู GitHub
git push -u origin $BRANCH --force

echo "โ ุชู ุฑูุน ุงููููุน ุนูู GitHub:"
echo "   ๐ $REPO_URL"
echo "ุจุนุฏูุง ุงุฑุจุทู ุจู Vercel ูู https://vercel.com/new"
